#!/bin/bash

# A simple script to perform first initialisation
cd ~/.aen/rest-gateway

# If the program is already running, kill it
# It's possible that this shell task was interrupted without closing REST properly
if pgrep -f "restnode" > /dev/null
then
    pkill -f "restnode"
fi

# Check whether the npm rebuild command has been run yet because, there is a
# high chance zeromq will need to be recompiled
if [ ! -e ~/.aen/var/rest_gateway_built ]; then
  npm rebuild
  echo "OK" > ~/.aen/var/rest_gateway_built
fi

sleep 5
npm start ~/.aen/resources/rest.json
